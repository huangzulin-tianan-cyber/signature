<html>

<head>

</head>

<body>

  <div id="context">
    <style>
      table,
      tr,
      td,
      span {
        margin: 10px;
        font-size:10.0pt;
        font-family:"微软雅黑","sans-serif"
      }
    </style>

    <table>
      <tr>
        <td style="font-size:14.0pt;font-weight: bold;text-align: center"><input placeholder="姓名" /></td>
        <td>
          <span><input placeholder="部门" /></span>
          <span><input placeholder="职位" /></span>
        </td>
      </tr>
      <tr>
        <td rowspan="5">
          <img width="170" height="51" src="https://oa.tianan-cyber.com/page/resource/userfile/image/logo.png" alt="天安数码城LOGO" />
        </td>
        <td>
          <span>天安数码城（集团）有限公司</span>
        </td>
      </tr>
      <tr>
        <td>
          <span style="width:70px">电 话：</span>
          <span><input placeholder="电话" /></span>
        </td>
      </tr>
      <tr>
        <td>
          <span style="width:70px">传真：</span>
          <span><input placeholder="传真" /></span>
        </td>
      </tr>
      <tr>
        <td>
          <span style="width:70px">E-mail：</span>
          <span><input placeholder="E-mail" /></span>
        </td>
      </tr>
      <tr>
        <td>
          <span>深圳市福田区天安数码城创新科技广场I期B座1909</span>
        </td>
      </tr>
    </table>
  </div>
  <div>
    <button onclick="preview()">预览</button>
    <button onclick="generate()">生成</button>
  </div>
  <div id="explain" style="color:red"></div>
  <script>
    function preview() {
      var inputs = document.getElementsByTagName("input");
      for (var i = inputs.length-1; i >=0 ; --i) {
        var input = inputs[i];
        var text = input.value;
        var parent = input.parentNode;
        parent.removeChild(input);
        parent.innerHTML = text;
      }

    }

    function generate() {
      var html = document.getElementById("context").innerHTML;
      var a = document.createElement("a");
      a.setAttribute("target","_blank");
      a.setAttribute("download","邮箱签名文件");
      a.setAttribute("href", 'data:text/html;charset=UTF-8,' + encodeURIComponent(html));
      a.click();
      document.getElementById("explain").innerHTML = "请把邮箱签名文件内容贴在 outlook/foxmail 签名处（html源码模式）";
    }
  </script>

</body>

</html>
